$(document).ready(function(){function t(t){var e=$(t);return e.summernote("code").replace(/<\/p>/gi,"\n").replace(/<br\/?>/gi,"\n").replace(/<\/?[^>]+(>|$)/g,"").replace(/&nbsp;/gi," ")}$("#output-result").summernote({placeholder:"You can write your own text here",tabsize:2,height:300,minHeight:null,maxHeight:null,focus:!0}),$("#document-form").submit(function(t){t.preventDefault(),$("#output-result").val($("#output-result").summernote("code"));var e=new FormData(this);$("#document_submit").attr("disabled",!0),$("#document_submit").addClass("d-none"),$("#document_loading").removeClass("d-none"),axios.post($(this).attr("action"),e).then(function(t){toastr.success(t.data.message),$("#document").attr("disabled",!1),$("#document_submit").removeClass("d-none"),$("#document_loading").addClass("d-none"),$("#response_id").val(t.data.data)}).catch(function(t,e){$("#document").attr("disabled",!1),$("#document_submit").removeClass("d-none"),$("#document_loading").addClass("d-none")})}),$("#copy-output-to-clipboard").on("click",function(){if("https:"!=window.location.protocol)toastr.error('Please use "https" protocol to copy image.');else{var e=t("#output-result"),o=document.createElement("textarea");o.value=e,document.body.appendChild(o),o.select(),navigator.clipboard.writeText(e).then(function(){toastr.success("Successfully copied to clipboard. You can paste it in any text editor.")},function(){toastr.error("Error copying to clipboard.")}),document.body.removeChild(o)}}),$("#export-output-to-txt").on("click",function(){var e=t("#output-result"),o=new Blob([e],{type:"text/plain"}),n=URL.createObjectURL(o),c=document.createElement("a");c.href=n,c.download="text.txt",document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(n)}),$("#export-output-to-word").on("click",function(){var t="<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset='utf-8'><title>Export HTML to Word Document with JavaScript</title></head><body>",e="</body></html>",o=$("#output-result").summernote("code"),n=t+o+e,c="data:application/vnd.ms-word;charset=utf-8,"+encodeURIComponent(n),a=document.createElement("a");document.body.appendChild(a),a.href=c,a.download="document.doc",a.click(),document.body.removeChild(a),toastr.success("Word document was created successfully")}),$("#print-output").on("click",function(){var t=$("#output-result").summernote("code"),e="";$("#template-print-setup")&&(e+=$("#template-print-setup").data("print-setup"));var o=window.open("url","print");o.document.write(e+t),o.document.close(),o.focus(),o.print(),o.close()})});